<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MCAP Setup in RHDP Lab :: Deploy Mission Critical Application Platform (MCAP)</title>
    <link rel="prev" href="index.html">
    <link rel="next" href="section2.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">Deploy Mission Critical Application Platform (MCAP)</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/mcap-deployment/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="mcap-deployment" data-version="1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Deploy Mission Critical Application Platform (MCAP)</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Hands-on Lab Environment Setup for MCAP</a>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="section1.html">MCAP Setup in RHDP Lab</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section2.html">Initial Setup on Hypervisor (Bare Metal)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section3.html">Ceph Storage Deployment</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter2/index.html">Hub Cluster Deployment</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter2/section1.html">Hub VM Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter2/section2.html">Install and Configure Operators and Service(s)</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter3/index.html">Infrastructure Cluster Deployment</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter3/section1.html">Infrastructure VM Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter3/section2.html">Install and Configure Operators</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../chapter4/index.html">Tenant Cluster Deployment</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter4/section1.html">Tenant VM Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../chapter4/section2.html">Install Sample Application on Tenant Cluster</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Deploy Mission Critical Application Platform (MCAP)</span>
    <span class="version">1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">Deploy Mission Critical Application Platform (MCAP)</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Deploy Mission Critical Application Platform (MCAP)</a></li>
    <li><a href="index.html">Hands-on Lab Environment Setup for MCAP</a></li>
    <li><a href="section1.html">MCAP Setup in RHDP Lab</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">MCAP Setup in RHDP Lab</h1>
<div class="sect1">
<h2 id="_overview"><a class="anchor" href="#_overview"></a>Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The MCAP solution is a combination of multiple Red Hat products working together to provide a robust, scalable, resilient, and highly available platform for an organizationâ€™s mission-critical applications.
The following Red Hat products are used in the MCAP solution:</p>
</div>
<div class="paragraph">
<p>Red Hat OpenShift Container Platform (OCP)</p>
</div>
<div class="paragraph">
<p>Red Hat OpenShift Virtualization (OCP Virt)</p>
</div>
<div class="paragraph">
<p>Red Hat Ansible Automation Platform (AAP)</p>
</div>
<div class="paragraph">
<p>Red Hat Advanced Cluster Management (RHACM)</p>
</div>
<div class="paragraph">
<p>Red Hat Advanced Cluster Security for Kubernetes (RHACS)</p>
</div>
<div class="paragraph">
<p>Red Hat OpenShift GitOps</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_rhdp_lab_environment"><a class="anchor" href="#_rhdp_lab_environment"></a>RHDP Lab Environment</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This setup is for Proof of Concepts (POC).
It is not recommended for Production use case.
For other architecture option, refer <a href="https://www.redhat.com/en/blog/nested-openshift-using-openshift-virtualization" target="read-later">Nested OpenShift using OpenShift Virtualization</a>
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/MCAP_setup.png" alt="MCAP setup">
</div>
</div>
<div class="paragraph">
<p>The following Red Hat products are used in this MCAP solution:</p>
</div>
<div class="paragraph">
<p>Red Hat OpenShift Container Platform (OCP)</p>
</div>
<div class="paragraph">
<p>Red Hat OpenShift Virtualization (OCP Virt)</p>
</div>
<div class="paragraph">
<p>Red Hat Advanced Cluster Management (RHACM)</p>
</div>
<div class="sect2">
<h3 id="_hardware_and_bare_metal"><a class="anchor" href="#_hardware_and_bare_metal"></a>Hardware and Bare-Metal</h3>
<div class="paragraph">
<p>In this lab, Equinix bare metal is used.
The flavor is <a href="https://deploy.equinix.com/product/bare-metal/servers/" target="read-later">n3.xlarge.x86</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_kernel_based_virtual_machines_kvm"><a class="anchor" href="#_kernel_based_virtual_machines_kvm"></a>Kernel-based Virtual Machines (KVM)</h3>
<div class="paragraph">
<p>In this MCAP solution, five Virtual Machines (VMs) are needed.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One virtual machine as shared storage for <em>Tenant</em> cluster.</p>
</li>
<li>
<p>One virtual machine as <em>Hub</em> cluster.</p>
</li>
<li>
<p>Three virtual machines as <em>Infrastructure</em> clusters.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_utility_and_services"><a class="anchor" href="#_utility_and_services"></a>Utility and Services</h3>
<div class="paragraph">
<p>The bare metal is acting as hypervisor, http server, dhcp server and dns server.
All these services are configured on the bare metal.</p>
</div>
</div>
<div class="sect2">
<h3 id="_networking"><a class="anchor" href="#_networking"></a>Networking</h3>
<div class="paragraph">
<p>As this setup uses KVMs as base infrastructure, all external communication and communication between clusters happen via virtual bridge on the bare metal.
nmstate operator is installed on the <em>Infrastructure</em> clusters.
nmstate operator allows users to configure various network interface types, DNS and routing on cluster nodes.
The configuration is driven by two main object types, NodeNetworkConfigurationPolicy (Policy) and NodeNetworkConfigurationEnactment (Enactment).
In this lab setup, NodeNetworkConfigurationPolicy (Policy) and NetworkAttachmentDefinition (Object) are configured to connect the <em>Tenant</em> cluster.</p>
</div>
</div>
<div class="sect2">
<h3 id="_storage"><a class="anchor" href="#_storage"></a>Storage</h3>
<div class="paragraph">
<p>On the hypervisor, 7TB (3.5TB + 3.5TB disks) LV is created and mounted to storage pool directory path.
There is separate storage virtual machine (VM) is created as shared storage for <em>Tenant</em> cluster.
This storage VM has three disks each of 2TB created from the 7TB LV.
These disks are used in Ceph deployment on storage VM.
OpenShift Data Foundation (ODF) operator is installed on the <em>Infrastructure</em> clusters.
OpenShift Data Foundation Cluster for external Ceph storage system is created.</p>
</div>
</div>
<div class="sect2">
<h3 id="_hub_cluster"><a class="anchor" href="#_hub_cluster"></a>Hub Cluster</h3>
<div class="paragraph">
<p><em>Hub</em> cluster is deployed as Single Node OpenShift (SNO) cluster.
<em>Hub</em> cluster acts as central cluster which is installed with Multi cluster engine, Red Hat Advanced Cluster Management (RHACM) and LVMS operators.
Provisioning and Central Infrastructure Management (CIM) service are deployed on <em>Hub</em> cluster.
<em>Infrastructure</em> clusters and <em>Tenant</em> cluster are deployed from <em>Hub</em> cluster and added to <em>Hub</em> cluster.</p>
</div>
</div>
<div class="sect2">
<h3 id="_infrastructure_cluster"><a class="anchor" href="#_infrastructure_cluster"></a>Infrastructure Cluster</h3>
<div class="paragraph">
<p>There are three <em>Infrastructure</em> clusters.
All are deployed as <em>Single Node OpenShift (SNO)</em> cluster.
These clusters are deployed with OpenShift Virtualization, OpenShift Data Foundation (ODF) and nmstate operators.
Discovery ISOs are uploaded to all <em>Infrastructure</em> clusters to deploy the <em>Tenant</em> cluster nodes.</p>
</div>
</div>
<div class="sect2">
<h3 id="_nested_openshift_vms_using_openshift_virtualization"><a class="anchor" href="#_nested_openshift_vms_using_openshift_virtualization"></a>Nested OpenShift VMs using OpenShift Virtualization</h3>
<div class="paragraph">
<p>Each <em>Infrastructure</em> cluster has one virtual machine acts as OpenShift node in <em>Tenant</em> cluster.</p>
</div>
</div>
<div class="sect2">
<h3 id="_tenant_cluster"><a class="anchor" href="#_tenant_cluster"></a>Tenant Cluster</h3>
<div class="paragraph">
<p>There is only one <em>Tenant</em> cluster.
This <em>Tenant</em> cluster is deployed as <em>Three-Node OpenShift Compact</em> cluster using virtual machines running on <em>Infrastructure</em> clusters.
All applications and workloads are running on <em>Tenant</em> cluster nodes.</p>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="index.html">Hands-on Lab Environment Setup for MCAP</a></span>
  <span class="next"><a href="section2.html">Initial Setup on Hypervisor (Bare Metal)</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
